<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pod PDB</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Wu, Shanliang" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../../css/main.css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="preset.html"> UP </a>
 |
 <a accesskey="H" href="pod.html"> HOME </a>
</div><div id="content">
<h1 class="title">Pod PDB</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org5f5a44a">自愿中断和非自愿中断</a></li>
<li><a href="#org4878f26">处理中断</a></li>
<li><a href="#orgea91cf7">工作原理</a></li>
<li><a href="#orgb6188cf">实例</a></li>
<li><a href="#orgd954e6b">分离集群所有者和应用程序所有者角色</a></li>
<li><a href="#org309407b">如何在集群上执行中断操作</a></li>
</ul>
</div>
</div>
<pre class="example" id="orgf065d2f">
这篇文档适用于要构建高可用应用程序的所有者，因此他们需要了解 Pod 可能发生什么类型的中断

也适用于要执行自动集群操作的集群管理员，如升级和集群自动扩容
</pre>
<div id="outline-container-org5f5a44a" class="outline-2">
<h2 id="org5f5a44a">自愿中断和非自愿中断</h2>
<div class="outline-text-2" id="text-org5f5a44a">
<p>
Pod 不会消失，直到有人（人类或控制器）将其销毁，或者当出现不可避免的硬件或系统软件错误。我们把这些不可避免的情况称为应用的 <span class="underline">非自愿性中断</span> 
</p>

<pre class="example" id="orgd001fff">
例如：后端节点物理机的硬件故障，集群管理员错误地删除虚拟机（实例），云提供商或管理程序故障使虚拟机消失，内核错误（kernel panic），节点由于集群网络分区而从集群中消失，由于节点资源不足而将容器逐出
</pre>

<p>
除资源不足的情况外，大多数用户应该都熟悉以下这些情况，它们不是特定于 Kubernetes 的。我们称这些情况为 <span class="underline">自愿中断</span> 。包括：
</p>
<ul class="org-ul">
<li><span class="underline">应用程序所有者</span> 操作包括：
<ul class="org-ul">
<li>删除管理该 pod 的 Deployment 或其他控制器</li>
<li>更新了 Deployment 的 pod 模板导致 pod 重启</li>
<li>直接删除 pod（意外删除）</li>
</ul></li>
<li><span class="underline">集群管理员操作</span> 包括：
<ul class="org-ul">
<li>排空（drain）节点进行修复或升级</li>
<li>从集群中排空节点以缩小集群</li>
<li>从节点中移除一个 pod，以允许其他 pod 使用该节点</li>
</ul></li>
</ul>

<p>
这些操作可能由集群管理员直接执行，也可能由集群管理员或集群托管提供商自动执行 
</p>

<pre class="example" id="orgd2cc222">
询问集群管理员或咨询云提供商或发行文档，以确定是否为集群启用了任何自动中断源
</pre>
</div>
</div>
<div id="outline-container-org4878f26" class="outline-2">
<h2 id="org4878f26">处理中断</h2>
<div class="outline-text-2" id="text-org4878f26">
<p>
以下是一些减轻非自愿性中断的方法：
</p>
<ul class="org-ul">
<li>确保 pod 请求所需的资源</li>
<li><p>
如果需要更高的可用性，请复制应用程序
</p>
<pre class="example" id="org755b1ef">
了解有关运行复制的无状态和有状态应用程序的信息
</pre></li>
<li>为了在运行复制应用程序时获得更高的可用性，请跨机架（使用反亲和性）或跨区域（如果使用多区域集群）分布应用程序</li>
</ul>

<p>
自愿中断的频率各不相同。在 Kubernetes 集群上，根本没有自愿的中断。但是，集群管理员或托管提供商可能会运行一些导致自愿中断的附加服务：
</p>
<pre class="example" id="org8053d1a">
例如，节点软件更新可能导致自愿更新

另外，集群（节点）自动缩放的某些实现可能会导致碎片整理和紧缩节点的自愿中断

集群管理员或主机提供商应该已经记录了期望的自愿中断级别（如果有的话）
</pre>

<p>
Kubernetes 提供的功能可以满足在频繁地自动中断的同时运行高可用的应用程序。这被称之为 <span class="underline">中断预算</span> 
</p>
</div>
</div>
<div id="outline-container-orgea91cf7" class="outline-2">
<h2 id="orgea91cf7">工作原理</h2>
<div class="outline-text-2" id="text-orgea91cf7">
<p>
<span class="underline">应用程序所有者</span> 可以为 <span class="underline">每个应用程序</span> <b>创建</b> 一个 <span class="underline">PodDisruptionBudget</span> 对象（PDB）。 PDB 将 <b>限制</b> 在 <span class="underline">同一时间</span> <b>自愿中断</b> 的 <span class="underline">复制应用程序</span> 中 <span class="underline">宕机的 Pod 的数量</span> 
</p>

<pre class="example" id="org58f32d3">
例如，基于定额的应用程序希望确保运行的副本数量永远不会低于仲裁所需的数量

Web 前端可能希望确保提供负载的副本的数量永远不会低于总数的某个百分比。
</pre>

<p>
集群管理器和托管提供商应使用遵循 Pod Disruption Budgets 的工具，方法是 <b>调用</b> <span class="underline">Eviction API</span> 而不是直接删除 Pod
</p>
<pre class="example" id="orgb1b60fc">
例如 kubectl drain 命令和 Kubernetes-on-GCE 集群升级脚本（cluster/gce/upgrade.sh）
</pre>

<p>
当集群管理员想要排空节点时，可以使用 kubectl drain 命令
</p>

<pre class="example" id="orgcb3b2b2">
该命令会试图驱逐机器上的所有 pod

驱逐请求可能会暂时被拒绝，并且该工具会定期重试所有失败的请求，直到所有的 pod 都被终止，或者直到达到配置的超时时间
</pre>

<p>
PDB 指定应用程序可以容忍的副本的数量，相对于应该有多少副本
</p>

<pre class="example" id="orgddce89f">
例如，具有 spec.replicas：5 的 Deployment 在任何给定的时间都应该有 5 个 Pod

如果其 PDB 允许在某一时刻有 4 个副本，那么驱逐 API 将只允许仅有一个而不是两个 Pod 自愿中断
</pre>

<p>
使用标签选择器来指定应用程序的一组 pod，这与应用程序的控制器（Deployment、StatefulSet 等）使用的相同
</p>

<pre class="example" id="org2431063">
Pod 控制器的 .spec.replicas 计算“预期的” pod 数量，使用对象的 .metadata.ownerReferences 值从控制器获取
</pre>

<p>
PDB 不能阻止非自愿中断的发生，但是它们确实会影响预算
</p>

<pre class="example" id="org4ac6eaa">
由于应用程序的滚动升级而被删除或不可用的 Pod 确实会计入中断预算，但控制器（如 Deployment 和 StatefulSet）在进行滚动升级时不受 PDB 的限制

在应用程序更新期间的故障处理是在控制器的 规格spec 中配置
</pre>

<p>
使用驱逐 API 驱逐 pod 时，pod 会被优雅地终止
</p>
</div>
</div>
<div id="outline-container-orgb6188cf" class="outline-2">
<h2 id="orgb6188cf">实例</h2>
<div class="outline-text-2" id="text-orgb6188cf">
<pre class="example" id="org9410f13">
假设集群有3个节点，node-1 到 node-3

集群中运行了一些应用，其中一个应用有3个副本，分别是 pod-a、pod-b 和 pod-c

另外，还有一个与它相关的不具有 PDB 的 pod，称为之为 pod-x
</pre>
<p>
最初所有 Pod 的分布如下：
</p>

<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">node-1</td>
<td class="org-left">node-2</td>
<td class="org-left">node-3</td>
</tr>

<tr>
<td class="org-left">pod-a available</td>
<td class="org-left">pod-b available</td>
<td class="org-left">pod-c available</td>
</tr>

<tr>
<td class="org-left">pod-x available</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<pre class="example" id="org6e0b80d">
所有的3个 pod 都是 Deployment 中的一部分，并且它们共同拥有一个 PDB，要求至少有3个 pod 中的2个始终处于可用状态 
</pre>


<p>
假设集群管理员想要重启系统，升级内核版本来修复内核中的错误。集群管理员首先使用 kubectl drain 命令尝试排除 node-1。该工具试图驱逐 pod-a 和 pod-x。这立即成功。两个 Pod 同时进入终止状态。这时的集群处于这种状态：
</p>

<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">node-1</td>
<td class="org-left">node-2</td>
<td class="org-left">node-3</td>
</tr>

<tr>
<td class="org-left">pod-a terminating</td>
<td class="org-left">pod-b available</td>
<td class="org-left">pod-c available</td>
</tr>

<tr>
<td class="org-left">pod-x terminating</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Deployment 注意到其中有一个 pod 处于正在终止，因此会创建了一个 pod-d 来替换。由于 node-1 被封锁（cordon），它落在另一个节点上。同时其它控制器也创建了 pod-y 作为 pod-x 的替代品 
</p>

<pre class="example" id="org08560c8">
注意：对于 StatefulSet，pod-a 将被称为 pod-1，需要在替换之前完全终止，替代它的也称为 pod-1，但是具有不同的 UID，可以创建

除此之外，示例也适用于 StatefulSet
</pre>

<p>
这时集群的状态如下：
</p>

<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">node-1</td>
<td class="org-left">node-2</td>
<td class="org-left">node-3</td>
</tr>

<tr>
<td class="org-left">pod-a terminating</td>
<td class="org-left">pod-b available</td>
<td class="org-left">pod-c available</td>
</tr>

<tr>
<td class="org-left">pod-x terminating</td>
<td class="org-left">pod-d starting</td>
<td class="org-left">pod-y</td>
</tr>
</tbody>
</table>

<p>
在某一时刻，pod 被终止，集群看起来像下面这样子：
</p>

<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">node-1</td>
<td class="org-left">node-2</td>
<td class="org-left">node-3</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">pod-b available</td>
<td class="org-left">pod-c available</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">pod-d starting</td>
<td class="org-left">pod-y</td>
</tr>
</tbody>
</table>

<p>
此时，如果一个急躁的集群管理员试图排空（drain）node-2 或 node-3，drain 命令将被阻塞
</p>
<pre class="example" id="org76ab94b">
因为对于 Deployment 只有2个可用的 pod，并且其 PDB 至少需要2个
</pre>

<p>
经过一段时间，pod-d 变得可用：
</p>

<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">node-1</td>
<td class="org-left">node-2</td>
<td class="org-left">node-3</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">pod-b available</td>
<td class="org-left">pod-c available</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">pod-d available</td>
<td class="org-left">pod-y</td>
</tr>
</tbody>
</table>

<p>
现在，集群管理员尝试排空 node-2。drain 命令将尝试按照某种顺序驱逐两个 pod，假设先是 pod-b，然后再 pod-d
</p>

<pre class="example" id="org42b137a">
它将成功驱逐 pod-b。但是，当它试图驱逐 pod-d 时，将被拒绝，因为这样对 Deployment 来说将只剩下一个可用的 pod
</pre>

<p>
Deployment 将创建一个名为 <span class="underline">pod-e</span> 的 <span class="underline">pod-b</span> 的替代品。但是，集群中没有足够的资源来安排 pod-e。那么，drain 命令就会被阻塞。集群最终可能是这种状态： 
</p>

<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">node-1</td>
<td class="org-left">node-2</td>
<td class="org-left">node-3</td>
<td class="org-left">no node</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">pod-c available</td>
<td class="org-left">pod-e pending</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">pod-d available</td>
<td class="org-left">pod-y</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
此时，集群管理员需要向集群中添加回一个节点以继续升级操作
</p>

<pre class="example" id="org65e4c53">
从这个例子里可以看到 Kubernetes 如何改变中断发生的速率，根据：

应用程序需要多少副本
正常关闭实例需要多长时间
启动新实例需要多长时间
控制器的类型
集群的资源能力
</pre>
</div>
</div>
<div id="outline-container-orgd954e6b" class="outline-2">
<h2 id="orgd954e6b">分离集群所有者和应用程序所有者角色</h2>
<div class="outline-text-2" id="text-orgd954e6b">
<p>
将集群管理者和应用程序所有者视为彼此知识有限的独立角色通常是很有用的。这种责任分离在这些情况下可能是有意义的：
</p>
<ul class="org-ul">
<li>当有许多应用程序团队共享一个 Kubernetes 集群，并且有自然的专业角色</li>
<li>使用第三方工具或服务来自动化集群管理</li>
</ul>

<p>
Pod Disruption Budget（Pod 中断预算） 通过在角色之间提供接口来支持这种角色分离。
</p>
<pre class="example" id="org9a84785">
如果组织中没有这样的职责分离，则可能不需要使用 Pod 中断预算
</pre>
</div>
</div>

<div id="outline-container-org309407b" class="outline-2">
<h2 id="org309407b">如何在集群上执行中断操作</h2>
<div class="outline-text-2" id="text-org309407b">
<p>
如果是集群管理员，要对集群的所有节点执行中断操作，例如节点或系统软件升级，则可以使用以下选择：
</p>
<ul class="org-ul">
<li>在升级期间接受停机时间</li>
<li>故障转移到另一个完整的副本集群。
<ul class="org-ul">
<li>没有停机时间，但是对于重复的节点和人工协调成本可能是昂贵的</li>
</ul></li>
<li>编写可容忍中断的应用程序和使用 PDB
<ul class="org-ul">
<li>没有停机时间</li>
<li>最小的资源重复</li>
<li>允许更多的集群管理自动化</li>
<li>编写可容忍中断的应用程序是很棘手的，但对于可容忍自愿中断，和支持自动调整以容忍非自愿中断，两者在工作上有大量的重叠</li>
</ul></li>
</ul>

<p>
<a href="preset.html">Previous：Pod Preset</a>
</p>

<p>
<a href="pod.html">Home: pod</a>
</p>
</div>
</div>
</div>
<div id="postamble" class="status">

		  <br/>
		  <div class='ds-thread'></div>
		  <script>
		  var duoshuoQuery = {short_name:'klose911'};
		  (function() {
					  var dsThread = document.getElementsByClassName('ds-thread')[0];
					  dsThread.setAttribute('data-thread-key', document.title);
					  dsThread.setAttribute('data-title', document.title);
					  dsThread.setAttribute('data-url', window.location.href);
					  var ds = document.createElement('script');
					  ds.type = 'text/javascript';ds.async = true;
					  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
					  ds.charset = 'UTF-8';
					  (document.getElementsByTagName('head')[0] 
						|| document.getElementsByTagName('body')[0]).appendChild(ds);
					  })();
		  </script>
		  <script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		  ga('create', 'UA-90850421-1', 'auto');
		  ga('send', 'pageview');
		  </script>
</div>
</body>
</html>
